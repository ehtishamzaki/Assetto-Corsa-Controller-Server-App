<UserControl x:Class="ACControllerServer.Views.ACClientsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ACControllerServer.Views" 
             xmlns:c="clr-namespace:ACControllerServer.Converters"
             xmlns:models="clr-namespace:ACControllerServer.Models"
             mc:Ignorable="d" d:Background="White"
             DataContext="{Binding RelativeSource={RelativeSource Self}}"
             d:DesignHeight="450" d:DesignWidth="300">
    <UserControl.Resources>
        <ResourceDictionary>

            <c:BoolToLedColor x:Key="BoolToLed" />
            <x:Array x:Key="FakeClients" Type="{x:Type models:ACClient}">
                <models:ACClient Id="127.0.0.1" Name="SUNNY-PC" IsConnected="True" IsSimulatorRunning="False" AssignedName="SUNNY" IsAssigned="True" />
                <models:ACClient Id="127.0.0.1" Name="Test PC 1" IsConnected="True" IsSimulatorRunning="False" AssignedName="" />
                <models:ACClient Id="127.0.0.1" Name="Test PC 1000" IsConnected="False" IsSimulatorRunning="False" AssignedName="dd" IsAssigned="True" />
            </x:Array>

            <Style x:Key="StatusLamp" TargetType="local:LedControl">
                <Setter Property="Height" Value="25" />
                <Setter Property="Width" Value="25" />
                <Setter Property="LedBorderThickness" Value="3" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="VerticalAlignment" Value="Stretch" />
                <Setter Property="IsAnimated" Value="False" />
            </Style>

            <Style TargetType="ListView">
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                <Setter Property="IsTextSearchEnabled" Value="False" />
                <Setter Property="Focusable" Value="True" />
            </Style>

            <Style x:Key="AssignButton" TargetType="Button">
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Stretch" />
                <Setter Property="Background" Value="#991C880C" />
                <Setter Property="Border.CornerRadius" Value="5" />
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="BorderBrush" Value="Black" />
                <Setter Property="MinWidth" Value="75" />
                <Setter Property="Padding" Value="10, 5" />
                <Setter Property="Margin" Value="10, 0" />
                <Setter Property="Width" Value="100" />

                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsAssigned}" Value="True">
                        <Setter Property="Visibility" Value="Collapsed" />
                    </DataTrigger>
                </Style.Triggers>
                <Style.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="5" />
                    </Style>
                </Style.Resources>
            </Style>
            <Style x:Key="ClearAssignmentButton" TargetType="Button">
                <Setter Property="ClickMode" Value="Press" />
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <ContentPresenter />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="NameLabel" TargetType="Label">
                <Setter Property="Foreground" Value="#FF4E5367" />
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="MaxWidth" Value="180" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                <Setter Property="VerticalAlignment" Value="Top" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
            </Style>
            <Style x:Key="TextLabel" TargetType="Label">
                <Setter Property="FontSize" Value="10" />
                <Setter Property="Padding" Value="5, 2" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="Foreground" Value="#FF4E5367" />
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
            </Style>
            <Style x:Key="DriverName" TargetType="Label">
                <Setter Property="Height" Value="20" />
                <Setter Property="FontSize" Value="12" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="Margin" Value="5,0" />
                <Setter Property="Foreground" Value="#FF0D8800" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=IsMouseOver}" Value="True">
                        <Setter Property="Foreground" Value="#FFCC1E1E" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Label Content="Clients" FontSize="14" Padding="3" FontWeight="Bold" HorizontalAlignment="Center" />
            <ListView Grid.Row="1" d:ItemsSource="{StaticResource FakeClients}"
                      ItemsSource="{Binding Clients}">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="Focusable" Value="false"/>
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderBrush" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                    </Style>
                </ListView.ItemContainerStyle>

                <ListView.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:ACClient}">

                        <UniformGrid>
                            <Border Margin="0, 2" Padding="2" CornerRadius="8" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
                                <Grid HorizontalAlignment="Stretch">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" SharedSizeGroup="A"/>
                                        <RowDefinition Height="*" SharedSizeGroup="A"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" SharedSizeGroup="A"/>
                                        <ColumnDefinition Width="*" SharedSizeGroup="A"/>
                                        <ColumnDefinition Width="*" SharedSizeGroup="A"/>
                                    </Grid.ColumnDefinitions>

                                    <Label Style="{StaticResource NameLabel}" Grid.Row="0" Grid.ColumnSpan="2" Content="{Binding Name}" />

                                    <Button x:Name="btnAssign" Grid.Row="1" Grid.ColumnSpan="2" 
                                        Style="{DynamicResource AssignButton}" Content="Assign"
                                        Focusable="True"
                                        Command="{Binding AssignCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                        CommandParameter="{Binding Id}" />
                                    <StackPanel Grid.Row="1" Grid.ColumnSpan="2" VerticalAlignment="Top" Margin="5, 0"
                                            Visibility="{Binding IsAssigned, Converter={StaticResource BoolToVisibility}}">
                                        <WrapPanel>
                                            <Label Style="{StaticResource TextLabel}" Content="Visitor Name:" HorizontalContentAlignment="Stretch" />
                                        </WrapPanel>
                                        <Button Style="{StaticResource ClearAssignmentButton}"
                                                Command="{Binding ClearAssignCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                CommandParameter="{Binding Id}">
                                            <Label Style="{StaticResource DriverName}" Content="{Binding AssignedName}" />
                                        </Button>
                                    </StackPanel>

                                    <StackPanel Grid.Row="0" Grid.Column="2" VerticalAlignment="Bottom">
                                        <Label Style="{StaticResource TextLabel}" Content="Connected:" />
                                        <local:LedControl Style="{StaticResource StatusLamp}"
                                              Fill="{Binding IsConnected, Converter={StaticResource BoolToLed}}" />
                                    </StackPanel>
                                    <StackPanel Grid.Row="1" Grid.Column="2" VerticalAlignment="Top">
                                        <Label Style="{StaticResource TextLabel}" Content="Simulator:" />
                                        <local:LedControl Style="{StaticResource StatusLamp}"
                                              Fill="{Binding IsSimulatorRunning, Converter={StaticResource BoolToLed}}" />
                                    </StackPanel>

                                </Grid>
                            </Border>
                        </UniformGrid>

                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
    </ScrollViewer>
</UserControl>
