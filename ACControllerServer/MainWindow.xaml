<Window x:Class="ACControllerServer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ACControllerServer"
        xmlns:pages="clr-namespace:ACControllerServer.Views"
        xmlns:converters="clr-namespace:ACControllerServer.Converters"
        mc:Ignorable="d" WindowStartupLocation="CenterScreen"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        Title="Assetto Corsa Controller" Width="450" Height="620"
        Background="#0d0d0d" AllowsTransparency="False">
    <Window.Resources>
        <ResourceDictionary>
            <pages:AssettoCorsa x:Key="TestAssettoCorsa" />
            <converters:BoolToColorConverter x:Key="BoolToColorConverter" TrueColor="#2ed573" FalseColor="#ff4757"/>
            <Style TargetType="Viewbox">
                <Setter Property="Stretch" Value="Uniform" />
            </Style>
            <Style TargetType="Image">
                <Setter Property="Stretch" Value="UniformToFill" />
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Border Background="#0d0d0d">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Padding="24,20">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#1a1a2e" Offset="0"/>
                        <GradientStop Color="#16213e" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="52" Height="52" CornerRadius="12" Margin="0,0,16,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#ff0844" Offset="0"/>
                                    <GradientStop Color="#ffb199" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="AC" FontWeight="Bold" FontSize="20" Foreground="White" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="Assetto Corsa Controller" FontSize="20" FontWeight="SemiBold" Foreground="White"
                                   VerticalAlignment="Center"/>
                    </StackPanel>

                    <Border Grid.Column="2" CornerRadius="8" Padding="14,8" VerticalAlignment="Center">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="#2a1f1f"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                        <Setter Property="Background" Value="#1f2a1f"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="10" Height="10" Margin="0,0,10,0">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="#ff4757"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                                <Setter Property="Fill" Value="#2ed573"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                            <TextBlock FontSize="13" FontWeight="SemiBold" VerticalAlignment="Center">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="Offline"/>
                                        <Setter Property="Foreground" Value="#ff6b81"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                                <Setter Property="Text" Value="Online"/>
                                                <Setter Property="Foreground" Value="#7bed9f"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Clients Section -->
            <Border Grid.Row="1" Margin="16,16,16,8" CornerRadius="16">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1a1a2e" Offset="0"/>
                        <GradientStop Color="#141422" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Padding="20,16" CornerRadius="16,16,0,0">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#1e1e32" Offset="0"/>
                                <GradientStop Color="#252540" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <StackPanel Orientation="Horizontal">
                            <Border Width="10" Height="10" CornerRadius="5" Background="#2ed573" Margin="0,0,12,0">
                                <Border.Effect>
                                    <DropShadowEffect Color="#2ed573" BlurRadius="8" ShadowDepth="0" Opacity="0.6"/>
                                </Border.Effect>
                            </Border>
                            <TextBlock Text="CONNECTED CLIENTS" FontSize="12" FontWeight="Bold" Foreground="#8888aa" 
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <ContentControl Grid.Row="1" Margin="12,8,12,12"
                                    d:Content="{d:DesignInstance pages:ACClientsView, IsDesignTimeCreatable=True}"
                                    Content="{Binding ACClientsPage}"/>
                </Grid>
            </Border>

            <!-- Simulator Control Section -->
            <Border Grid.Row="2" Margin="16,8,16,8" CornerRadius="16" Padding="20,16">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1a1a2e" Offset="0"/>
                        <GradientStop Color="#141422" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="0,0,0,14">
                        <TextBlock Text="Simulator Control" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock Text="Power on/off all simulator PCs" FontSize="12" Foreground="#6666aa" Margin="0,4,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button x:Name="btnPowerOnAll"  Cursor="Hand"
                                Width="150" Height="42" Margin="0,0,12,0">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" CornerRadius="10" Padding="16,8">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#00b894" Offset="0"/>
                                                <GradientStop Color="#00cec9" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="⏻" FontSize="16" Foreground="White" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Power On All" FontSize="13" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <Button x:Name="btnPowerOffAll"   Cursor="Hand"
                                Width="150" Height="42">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border" CornerRadius="10" Padding="16,8">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#e17055" Offset="0"/>
                                                <GradientStop Color="#d63031" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="⏻" FontSize="16" Foreground="White" Margin="0,0,10,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Power Off All" FontSize="13" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Server Manager Status -->
            <Border Grid.Row="3" Margin="16,8,16,16" CornerRadius="16" Padding="20,16">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#1a1a2e" Offset="0"/>
                        <GradientStop Color="#1e1e35" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                        <TextBlock Text="Server Manager" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock Text="Race server connection status" FontSize="12" Foreground="#6666aa" Margin="0,4,0,0"/>
                    </StackPanel>

                    <Border Grid.Column="1" CornerRadius="10" Padding="16,10" VerticalAlignment="Center">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="#2a1f1f"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                        <Setter Property="Background" Value="#1f2a1f"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="14" Height="14" Margin="0,0,10,0">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="#ff4757"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                                <Setter Property="Fill" Value="#2ed573"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                                <Ellipse.Effect>
                                    <DropShadowEffect ShadowDepth="0" BlurRadius="10" Opacity="0.8">
                                        <DropShadowEffect.Color>
                                            <Binding Path="ServerManagerPage.IsConnected">
                                                <Binding.Converter>
                                                    <converters:BoolToColorConverter TrueColor="#2ed573" FalseColor="#ff4757"/>
                                                </Binding.Converter>
                                            </Binding>
                                        </DropShadowEffect.Color>
                                    </DropShadowEffect>
                                </Ellipse.Effect>
                            </Ellipse>
                            <TextBlock FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="Disconnected"/>
                                        <Setter Property="Foreground" Value="#ff6b81"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ServerManagerPage.IsConnected}" Value="True">
                                                <Setter Property="Text" Value="Connected"/>
                                                <Setter Property="Foreground" Value="#7bed9f"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- HIDDEN FOR NOW -->
            <ContentControl Visibility="Collapsed"
                            d:Content="{d:DesignInstance pages:AssettoCorsa, IsDesignTimeCreatable=True}"
                            Content="{Binding AssettoCorsaPage}" />
        </Grid>
    </Border>
</Window>